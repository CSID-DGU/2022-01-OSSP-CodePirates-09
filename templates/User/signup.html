<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sign-up page</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans KR', sans-serif;
        }

        html,
        body {
            height: 100%;
        }

        body {
            background-color: #f5f5f5;
        }

        a {
            text-decoration: none;
        }

        #content {
            position: relative;
            top: calc(35vh - 250px);
            width: 500px;
            height: 800px;
            background-color: rgba(255, 255, 255, 0.5);

            border-radius: 20px;
            border: solid 1px rgba(0, 0, 0, 0.08);
            box-shadow: 0 0 50px 0 rgba(0, 0, 0, 0.04);
            margin: 0 auto;

            text-align: center;
        }

        .logo {
            margin: 50px 0px;
            width: 135px;
        }

        .signup_input_text {
            width: 330px;
            height: 50px;
            border-radius: 11px;
            border: solid 1px #dfdfdf;
            background: #fff;
            margin-bottom: 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 16px;
        }

        .signup_input_text::placeholder {
            color: #c6c6c6;
        }

        select {
            width: 108px;
            height: 50px;
            border-radius: 11px;
            border: solid 1px #dfdfdf;
            background: #fff;
            margin-bottom: 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 16px;
        }

        #sex_select, #age_select {
            width: 330px;
            height: 50px;
            border-radius: 11px;
            border: solid 1px #dfdfdf;
            background: #fff;
            margin-bottom: 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 16px;
        }

        .signup_btn, .signup_cancel_btn {
            width: 165px;
            height: 50px;
            border-radius: 11px;
            background-color: #5f29e2;
            font-weight: bold;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }

        .signup_btn:hover, .signup_cancel_btn:hover {
            background-color: #410BC4;
        }
    </style>
</head>

<body>
<div id="content">
    <img class="logo" alt="logo" src="images/#">

    <form>
        <input type="text" name="username" class="signup_input_text" placeholder="이름을 입력하세요"><br>
        <input type="text" name="email" class="signup_input_text" placeholder="이메일을 입력하세요"><br>
        <input type="text" name="id" class="signup_input_text" placeholder="아이디를 입력하세요"><br>
        <input type="password" name="password" class="signup_input_text" placeholder="비밀번호를 입력하세요"><br>
        <input type="password" name="passwordcheck" class="signup_input_text" placeholder="비밀번호를 다시 입력하세요"><br>

        취향 선택<br>
        <select size="1">
            <option selected>밥집</option>
            <option value="1">가성비좋은</option>
            <option value="2">분위기좋은</option>
            <option value="3">시끌벅적한</option>
            <option value="4">고급스러운</option>
            <option value="5">조용한</option>
            <option value="6">깔끔한</option>
            <option value="7">예쁜</option>
        </select>

        <select size="1">
            <option selected>술집</option>
            <option value="1">가성비좋은</option>
            <option value="2">분위기좋은</option>
            <option value="3">시끌벅적한</option>
            <option value="4">고급스러운</option>
            <option value="5">조용한</option>
            <option value="6">깔끔한</option>
            <option value="7">예쁜</option>
        </select>

        <select size="1">
            <option selected>카페</option>
            <option value="1">가성비좋은</option>
            <option value="2">분위기좋은</option>
            <option value="3">시끌벅적한</option>
            <option value="4">고급스러운</option>
            <option value="5">조용한</option>
            <option value="6">깔끔한</option>
            <option value="7">예쁜</option>
        </select>

        <br>
        성별
        <br>
        <select size="1" id="sex_select">
            <option selected>성별</option>
            <option value="1">남자</option>
            <option value="2">여자</option>
        </select>

        <br>나이<br>
        <select size="1" id="age_select">
            <option selected>나이</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
            <option value="23">23</option>
            <option value="24">24</option>
            <option value="25">25</option>
            <option value="26">26</option>
            <option value="27">27</option>
            <option value="28">28</option>
            <option value="29">29</option>
            <option value="30">30</option>
        </select>
        <br>
        <input type="submit" class="signup_btn" value="완료">
        <input type="button" class="signup_cancel_btn" value="취소">
        <br>
    </form>

</div>
</body>
    
<script>

$(function(){
	<!-- 회원가입 버튼 -->
	$('#signUpSubmit').click(function(e)
	{
		e.preventDefault();
		
		<!-- 사용자 이름 확인 -->
		if($("#userName").val()=='')
		{
			alert('이름을 입력하세요.');
			$("#userName").focus();
			return false;
		}
		
		<!-- 사용자 이메일 확인 -->
		var userEmail = $('#userEmail').val();
		if(userEmail=='')
		{
			alert('이메일을 입력하세요.');
			$("userEmail").focus();
			return false;
		}
		else
		{
			var userEmailCheck = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
			if(!userEmailCheck.test(userEmail))
				{
					alert('이메일 주소가 유효하지 않습니다. 예시) abc@email.com');
					$("#userEmail").focus();
					return false;
				}
		}
		
		<!-- 비밀번호 확인 -->
		if($("#userPassword").val()=='')
		{
			alert('비밀번호를 입력하세요.');
			$("#userPassword").focus();
			return false;
		}
		
		<!-- 비밀번호 재확인 -->
		if($("#userPasswordCheck").val()=='')
		{
			alert('비밀번호를 입력하세요.');
			$("#userPasswordCheck").focus();
			return false;
		}
		
		<!-- 비밀번호 재확인 검증 -->
		if($("#userPasswordCheck").val()=="#userPassword".val())
		{
			alert('비밀번호가 동일하지 않습니다.');
			return false;
		}
		
		$.ajax
		({
			url:'register.php',
			type:'POST',
			data:
			{
				userName:$("#userName").val(),
				userEmail:$("#userEmail").val(),
				userPassword:$("#userPassword").val(),
				userPreference:$("#userPreference").val(),
				partnerEmail:$("#partnerEmail").val()
			},
			dataType:"json",
			success:function(response)
			{
				if(response.result==1)
				{
					alert('가입을 환영합니다.');
					location.replace('../index.php'); // 화면 갱신
				}
				else if(respons.result==0)
				{
					alert('이미 가입된 이메일입니다.');
				}
				else if(response.result==2)
				{
					alert('입력된 사항이 없습니다.');
				}
				else
				{
					alert('등록 중 에러가 발생했습니다.');
				}
			},
			error.function(jqXHR, textStatus, errorThrown)
			{
				alert("arjax error : " + textStatus + "\n" + errorThrown);
			}
		});
	});
});

<!-- register.php 파일, PDO 클래스 활용 -->
<?php
extract($_POST);
if(isset($_POST))
{
	require_once '${pageContext.request.contextPath}/config/config.php';
	$c=new MembeClass();
	// 동일한 userEmail 등록 확인
	if($c->isUserExisted($userID))
	{
		echo '{"result":"0"}';	// echo json_encode(array('result=>'0'));과 동일
	}
	else
	{
		// 회원 등록
		$user=$c->storeUser($userEmail, $userName, $userPassword, $userPreference, $partnerEmail);
		if($user)
		{
			// 회원 등록 성공
			if(!isset($_SESSION))
			{
				session_start();
			}
			$_SESSION('userEmail')=$user['userEmail'];
			$_SESSION('admin')=$user['admin'];
			echo json_encode(array('result=>'1'));
		}
		else
		{
			// 회원 등록 실패
			echo json_encode(array('result=>'-1'));
		}
	}
}
else
{
	// 입력받은 데이터에 오류 존재
	echo json_encode(array('result=>'-2'));
}
?>

</script>
</html>
